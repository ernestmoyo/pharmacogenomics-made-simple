# Changelog

All notable changes to the PGx Clinical Solutions platform will be documented in this file.

Format follows [Semantic Versioning](https://semver.org/).

---

## [0.5.0-validated] - 2026-03-02

### Added
- **12 new validation test cases** (24 total across all modules):
  - 6 oncology gap analysis test cases (TC_GAP01-TC_GAP06): testing gap detection, missed interventions, population aggregation, compliant patient baseline
  - 6 geriatric deprescribing test cases (TC_DEP01-TC_DEP06): Beers screening, ACB scoring, cascade detection, polypharmacy scoring, PGx overlay validation
- `run_full_validation()` method: runs all 24 test cases across PGx, gap, and deprescribing modules
- `generate_full_impact_report()`: combined validation report covering all modules
- `--validate-only` now runs all 24 test cases (up from 12)

### Changed
- Updated `docs/standards/validation_methodology.md` with full documentation of all 24 test cases

---

## [0.5.0] - 2026-03-02

### Added
- **Professional HTML Report Templates**:
  - `gap_analysis_report.html` — population-level oncology gap analysis with executive dashboard, testing rates bar chart, top gaps table, per-patient results, and institutional recommendations
  - `deprescribing_report.html` — per-patient deprescribing dashboard with polypharmacy score, medication flag table (Beers/STOPP/ACB/Cascade/PGx dot indicators), PGx overlay section, cascade cards, and prioritized recommendations
- `--full` CLI mode: runs all three modules (standard PGx + oncology gap + deprescribing) in sequence with combined summary
- Report generation methods in `generator.py`: `generate_gap_analysis_report()`, `generate_deprescribing_report()`, `generate_all_deprescribing_reports()`
- HTML reports auto-generated by `--oncology-gap` and `--deprescribing` modes

### Changed
- `PLATFORM_VERSION` updated to `0.5.0`
- Both `run_oncology_gap()` and `run_deprescribing()` now produce HTML reports alongside JSON output
- All report templates share consistent CSS design system (navy/slate colors, severity badges, evidence badges)

---

## [0.4.0] - 2026-03-02

### Added
- **Geriatric Deprescribing Module** (`src/deprescribing/`):
  - `beers_checker.py` — 2023 AGS Beers Criteria screening (age 65+)
  - `stopp_start_checker.py` — STOPP/START v3 criteria with condition-aware filtering
  - `anticholinergic_scorer.py` — cumulative ACB scoring with risk classification
  - `cascade_detector.py` — prescribing cascade pattern detection
  - `polypharmacy_scorer.py` — composite 0-100 risk score from 6 weighted components
  - `deprescribing_recommender.py` — orchestrator with prioritized recommendations and PGx overlay
- 12 synthetic geriatric patients (age 69-92, 5-15 meds each) with realistic polypharmacy scenarios
- `--deprescribing` CLI mode in `main.py`
- PGx overlay analysis: highlights what pharmacogenomics reveals beyond standard Beers/STOPP criteria
- JSON output to `output/deprescribing/`

---

## [0.3.0] - 2026-03-01

### Added
- **Oncology Gap Analysis Module** (`src/oncology_gap/`):
  - `gap_analyzer.py` — identifies PGx testing gaps and missed interventions per patient
  - `ddi_burden_scorer.py` — quantifies DDI load with severity-weighted scoring
  - `population_analytics.py` — aggregates gap statistics across patient cohorts
- 15 synthetic oncology gap analysis patients in `synthetic_patients.py`:
  - 5 gap patients (PGx-relevant drugs, no testing)
  - 5 missed intervention patients (testing done, actionable results, no action)
  - 3 compliant patients (fully tested, results appropriate)
  - 2 complex DDI patients (multiple PGx interactions)
- `--oncology-gap` CLI mode in `main.py`
- JSON output to `output/oncology_gap/` (gap_results, ddi_burden, population_summary)
- Formatted console report with cohort overview, testing rates, gap analysis, missed interventions

---

## [0.3.0-kb] - 2026-03-01

### Added
- `pgx_drug_map.json` — 39 drugs mapped to pharmacogenes across 7 therapeutic areas with CPIC levels, FDA label status, and testing recommendations
- `beers_criteria.json` — 45 entries from the 2023 AGS Beers Criteria for potentially inappropriate medications in older adults
- `stopp_start_criteria.json` — 20 STOPP criteria (medications to stop) + 10 START criteria (medications to start) from STOPP/START v3
- `anticholinergic_burden.json` — 97 medications scored on the Anticholinergic Cognitive Burden (ACB) scale (0-3) with risk thresholds
- `prescribing_cascades.json` — 15 well-documented prescribing cascade patterns with PGx relevance annotations
- New `KnowledgeBase` lookup methods: `get_pgx_relevant_genes()`, `get_pgx_drug_info()`, `get_beers_flag()`, `get_stopp_flags()`, `get_start_flags()`, `get_acb_score()`, `get_total_acb_score()`, `get_prescribing_cascades()`

### Changed
- `kb_loader.py` now loads all 8 knowledge base files and builds indexes for fast lookups
- `get_kb_versions()` includes all KB files in version tracking
- KB load summary now reports PGx-mapped drug count, Beers entries, and ACB-scored medications

---

## [0.2.0] - 2026-03-01

### Added
- Centralized logging system (`src/utils/logger.py`) with console + file handlers
- Audit trail system — every pipeline run recorded to `output/logs/audit_trail.json`
- Version metadata (`_metadata`) on all knowledge base JSON files
- `CHANGELOG.md` for version tracking
- `docs/standards/` directory with clinical references, validation methodology, and data provenance documentation
- `get_kb_versions()` method on KnowledgeBase class
- Platform version constant (`PLATFORM_VERSION`) as single source of truth

### Changed
- Replaced all `print()` statements with Python `logging` module across all modules
- Report metadata now uses `PLATFORM_VERSION` instead of hardcoded version string
- `.gitignore` updated to exclude `output/` directory and `nul` artifact

### Removed
- `nul` file (Windows artifact) from project root

---

## [0.1.0] - 2026-02-08

### Added
- Initial MVP release
- Knowledge base: 21 gene-drug interactions across 10 genes, 14 DDIs, dosing guidelines
- Interpretation engine with gene-drug, DDI, phenoconversion, renal/hepatic analysis
- Risk scoring system (0-100 scale) with evidence quality weighting
- Clinical recommendation generator with prioritization and alternatives
- 25 synthetic patients across 4 therapeutic areas (psychiatry, oncology, pain management, cardiology)
- Professional HTML clinical report generation via Jinja2
- Clinical validation suite: 12 test cases, 100% accuracy
- Business model documentation
- CSV data exports
